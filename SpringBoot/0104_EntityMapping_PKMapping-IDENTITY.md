# 04. Entity Mapping - 기본 키 매핑 IDENTITY 전략
###### 인프런 - [자바 ORM 표준 JPA 프로그래밍 - 기본편](https://www.inflearn.com/course/ORM-JPA-Basic)
###### 실습 GitHub Repository: hello-jpa의 커밋 번호 - [1d454d4](https://github.com/EunseongHeo/hello-jpa/commit/ee58488a2fdab5d106b7a34cac83b11689940c16)

***
## 기본 키 매핑 - IDENTITY 전략
- `@Id @GeneratedValue(strategy = GenerationType.IDENTITY)`
- Member 클래스 코드 일부
  ```java
  import javax.persistence.*;
  
  @Entity
  public class Member {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
  
    //...(생략)...
  }
  ```

- Main 클래스의 일부 코드
  ```java
    public Main class{
        public static void main(String[] args){
            // EntitManagerFactory 객체 생성: emf
            // EntityManger 객체 생성: em
            // EntityTransaction 객체 생성: tx
            tx.begin();
            try{
                System.out.println("=============================");
                em.persist(member);
                System.out.println("member.id = " + member.getId());
                System.out.println("=============================");
                tx.commit();
            } 
            //...(생략)...
        }
    }
  ```
- JPA가 생성한 CREATE SQL
  - `generated by default as identity`
  - ```
    create table member(
    id bigint generated by default as identity,
    name varchar(255),
    primary key (id)
    );
    ```
- 콘솔 결과
  ```
  =============================
  Hibernate: 
      /* insert Member
          */ insert 
          into
              Member
              (id, name) 
          values
              (null, ?)
  member.id = 1
  =============================
  ```
***
## IDENTITY 전략의 특징
>1. PK 값은 null인 상태
>2. `em.persistence(객체);` 실행 시 INSERT 쿼리 실행
>3. PK 값이 null이기 때문에 DB가 자동으로 적절한 PK 값을 매핑함
>> ※ `generated by default as identity` ※ 
> 4. DB에서 입력한 PK 값을 JPA 조회하여 1차 캐시에 저장

- 기본 키 생성을 데이터베이스에 위임
- `em.persist()` 시점에 즉시 INSERT SQL를 실행 <font color='gray' style='text-decoration:line-through;'>em.commit(); 시점이 아님</font>
- 즉, INSERT SQL 실행 시, 쓰기 지연 기능이 동작하지 못함
